package dns

import (
	"fmt"
	"testing"
)

func TestDNSHeader(t *testing.T) {
	packetData := []byte{
		0xcb, 0x0d, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, //  ........    16
		0x00, 0x00, 0x00, 0x00, 0x07, 0x73, 0x75, 0x70, //  .....sup    24

		0x70, 0x6f, 0x72, 0x74, 0x11, 0x73, 0x70, 0x72, //  port.spr    32
		0x69, 0x6e, 0x67, 0x62, 0x6f, 0x61, 0x72, 0x64, //  ingboard    40
		0x72, 0x65, 0x74, 0x61, 0x69, 0x6c, 0x03, 0x63, //  retail.c    48
		0x6f, 0x6d, 0x00, 0x00, 0x01, 0x00, 0x01, //  om.....     56
	}

	packetData2 := []byte{
		0xfd, 0xe2, 0x01, 0x00, 0x00, 0x01, 0x00, 0x00, //  ........    16
		0x00, 0x00, 0x00, 0x00, 0x08, 0x63, 0x6c, 0x69, //  .....cli    24

		0x65, 0x6e, 0x74, 0x73, 0x31, 0x06, 0x67, 0x6f, //  ents1.go    32
		0x6f, 0x67, 0x6c, 0x65, 0x03, 0x63, 0x6f, 0x6d, //  ogle.com    40
		0x00, 0x00, 0x01, 0x00, 0x01, //  .....       48
	}

	packetData3 := []byte{
		0x1e, 0xc3, 0x81, 0x80, 0x00, 0x01, 0x00, 0x03, //  ........    16
		0x00, 0x00, 0x00, 0x00, 0x03, 0x75, 0x73, 0x65, //  .....use    24

		0x07, 0x74, 0x79, 0x70, 0x65, 0x6b, 0x69, 0x74, //  .typekit    32
		0x03, 0x6e, 0x65, 0x74, 0x00, 0x00, 0x01, 0x00, //  .net....    40
		0x01, 0xc0, 0x0c, 0x00, 0x05, 0x00, 0x01, 0x00, //  ........    48
		0x00, 0x00, 0x05, 0x00, 0x17, 0x03, 0x77, 0x61, //  ......wa    56

		0x63, 0x04, 0x30, 0x46, 0x38, 0x38, 0x0b, 0x65, //  c.0F88.e    64
		0x64, 0x67, 0x65, 0x63, 0x61, 0x73, 0x74, 0x63, //  dgecastc    72
		0x64, 0x6e, 0xc0, 0x18, 0xc0, 0x2d, 0x00, 0x05, //  dn...-..    80
		0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x00, 0x10, //  ........    88

		0x03, 0x67, 0x70, 0x31, 0x03, 0x77, 0x61, 0x63, //  .gp1.wac    96
		0x05, 0x76, 0x32, 0x63, 0x64, 0x6e, 0xc0, 0x18, //  .v2cdn..   104
		0xc0, 0x50, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, //  .P......   112
		0x00, 0x05, 0x00, 0x04, 0x48, 0x15, 0x5b, 0x13, //  ....H.[.   120

	}

	packet, _ := NewPacket(packetData)
	fmt.Println(packet)
	fmt.Println("----------")

	packet2, _ := NewPacket(packetData2)
	fmt.Println(packet2)
	fmt.Println("----------")

	packet3, _ := NewPacket(packetData3)
	fmt.Println(packet3)
}
